<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>D:IV_vision運営</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <style>
  
    /* 全体レイアウト（中央配置） */
    body {
      font-family: "Noto Sans JP", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      min-height: 100svh; /* モバイルのアドレスバー考慮 */
      margin: 0; background: #f8f8f8;
      -webkit-text-size-adjust: 100%;
    }


    /* 見出しはクランプで自動調整（最小16px～理想20px～最大24px） */
    h1 {
      margin: 0 16px 12px;
      font-size: clamp(16px, 2.5vw, 24px);
      text-align: center;
    }

    /* フォーム本体 */
    #gate {
      width: 320px;
      text-align: center; /* ボタンを中央寄せ */
    }

    /* ロゴは端末幅に応じて縮む */
    .logo {
      width: 800px;
      max-width: min(90vw, 800px);
      height: auto;
      margin-bottom: 10px;
      display: block;
    }
    
    /* フォームの箱は“端末幅に合わせて縮む” */
    #gate {
      width: min(92vw, 340px);   /* PCでは340px、スマホでは画面幅に追従 */
      text-align: center;
      margin: 8px 0;
    }

    /* 入力欄は箱いっぱい・フォントはクランプで可変 */
    #gate input {
      display: block;
      width: 100%;
      box-sizing: border-box;
      text-align: center;
      padding: 12px;
      margin: 15px 0 24px;
      font-size: clamp(16px, 4vw, 20px); /* iOSのズーム防止で最小16px */
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #fff;
    }

    #gate input::placeholder { text-align: center; }

    /* ボタンは元サイズのまま。フォントだけ可変 */
    #gate button {
      display: inline-block;
      width: auto;
      padding: 8px 14px;
      font-size: clamp(16px, 3.5vw, 20px);
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #000; color: #fff; cursor: pointer;
    }
    
    
    #gate button:hover { background: #3b74d9; }
    

    /* 右下フッター（4行構成のまま、1・2行だけ折り返し禁止） */
    .footer-text {
      position: fixed;
      right: calc(env(safe-area-inset-right) + 10px);
      bottom: calc(env(safe-area-inset-bottom) + 10px);
      font-size: 12px;
      color: #666;
      line-height: 1.5;
      text-align: right;
      max-width: 96vw; /* 画面の端からはみ出しを抑える */
    }
    
    
    
    .footer-text .nowrap {
      white-space: nowrap;       /* 折り返し禁止（1・2行目に付与） */
      display: inline-block;     /* 右寄せのまま一塊として扱う */
      max-width: 96vw;           /* 万一長い場合の保険 */
      overflow-x: auto;          /* はみ出す時は横スクロールで全文読める */
      -webkit-overflow-scrolling: touch;
    }

  </style>

  <!-- HTML構築後に実行させる -->
  <script defer>
    // 合言葉の SHA-256 (UTF-8)
    const SECRET_SHA256 = "e1bf06d5a7ed74852ee9e76dd9a05f600a4fe0c4275ace7876a6eec1ec6d05fc";

    // 遷移先（日本語を含むので念のためエンコード版を使用）
    const DEST = "https://sites.google.com/view/divvision/%E3%83%9B%E3%83%BC%E3%83%A0";

    const toHex = (buf) => [...new Uint8Array(buf)]
      .map(b => b.toString(16).padStart(2, "0"))
      .join("");

    async function sha256Hex(text) {
      if (!(window.crypto && crypto.subtle)) {
        alert("この環境では検証処理が使えません。HTTPSのサイト上でお試しください。");
        throw new Error("SubtleCrypto not available");
      }
      const data = new TextEncoder().encode(text);
      const digest = await crypto.subtle.digest("SHA-256", data);
      return toHex(digest);
    }

    window.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("gate");
      const input = document.getElementById("key");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        try {
          // 前後空白を削除し、全角/半角の揺れを抑える
          const raw = input.value.trim().normalize("NFKC");
          const h = await sha256Hex(raw);
          if (h === SECRET_SHA256) {
            window.location.href = DEST;
          } else {
            alert("合言葉が違います。");
          }
        } catch (err) {
          console.error(err);
        }
      });
    });
  </script>
</head>

<body>
  <img src="DIV--B.png" alt="D:IV_vision ロゴ" class="logo">

  <h1>D:IV_vision運営チームです。</h1>
  <h1>アリスから受け取った合言葉をご入力ください。</h1>

  <form id="gate">
    <input id="key" type="text" placeholder="合言葉を入力してください" required />
    <button type="submit">ENTER</button>
  </form>

	<div class="footer-text">
	  <span class="nowrap">こちらは非公式・第四境界Webオンリー謎解き企画の関連ページです。</span><br>
	  <span class="nowrap">第四境界公式および実在の人物・団体とは一切関係がありません。</span><br>
	  主催：D:Ⅳ_vision運営<br>
	  連絡先：d4kk.webonly@gmail.com
	</div>

</html>
